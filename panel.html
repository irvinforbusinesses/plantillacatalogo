<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel del Operador</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@600&display=swap" rel="stylesheet">
<style>
:root {
  --color-bg: #E8F0F5;
  --color-accent: #2F528F;
  --color-light: #FFFFFF;
  --color-gray: #F6F8FB;
  --color-text-dark: #1A1A1A;
}
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Inter', sans-serif;
  background: var(--color-bg);
  color: var(--color-text-dark);
  padding: 0.1rem;
  max-width: 500px;
  margin: auto;
}

/* --------- NAV/SECCIONES ORIGINALES --------- */
header { text-align: center; margin-bottom: 2rem; }
h1 { font-family: 'Poppins', sans-serif; font-size: 1.8rem; color: var(--color-accent); }
nav { display: flex; justify-content: center; gap: 0.5rem; margin-top: 1rem; }
nav button { flex: 1; background: var(--color-accent); color: white; border: none; padding: 0.75rem; font-weight: bold; border-radius: 8px; cursor: pointer; }
nav button.inactive { background: #a0b6e0; }

section { background: var(--color-light); padding: 1.5rem; border-radius: 12px; margin-top: 1rem; display: none; }
section.active { display: block; }

label { display: block; margin: 1rem 0 0.5rem; font-weight: 600; }
input, select, textarea { width: 100%; padding: 0.75rem; border-radius: 8px; border: 1px solid #ccc; font-size: 1rem; }
input::placeholder { color: #9aa3ad; }
textarea { resize: vertical; }

button.action-btn { margin-top: 1rem; background: var(--color-accent); color: white; border: none; padding: 0.75rem; font-size: 1rem; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; }

.recordatorio-item {
  background: var(--color-gray);
  padding: 0.75rem;
  border-radius: 16px;
  margin-bottom: 0.75rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  overflow: hidden;
}

.recordatorio-info {
  flex: 1;
  border-radius: 12px;
  padding: 0.4rem;
}
.btnEliminar { 
  background: #f56565; 
  color: white; 
  border: none; 
  padding: 0.35rem 0.6rem;
  border-radius: 12px;
  font-size: 0.75rem;
  cursor: pointer; 
  transition: background 0.2s ease;
}
.btnEliminar:hover { background: #ff6b6b; }

/* NUEVO: estilo para item de pedido (mismo tamaño/estética que recordatorio) */
.pedido-item {
  background: var(--color-gray);
  padding: 0.75rem;
  border-radius: 16px;
  margin-bottom: 0.75rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  overflow: hidden;
  cursor: pointer;
}
.pedido-info { flex:1; padding:0.4rem; }
.pedido-meta { text-align:right; font-size:0.9rem; color:#444; }

/* Pop-ups (tus existentes) */
.popUp, .confirmPop { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--color-light); padding: 1rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 999; }
.popUp button, .confirmPop button { margin-top: 0.5rem; width: 100%; }

/* Animación parpadeo */
@keyframes parpadeo {
  0% { background-color: var(--color-light); color: var(--color-text-dark); transform: scale(1); }
  25% { background-color: #e0f0ff; color: var(--color-accent); transform: scale(1.02); }
  50% { background-color: var(--color-accent); color: #fff; transform: scale(1.05); }
  75% { background-color: #e0f0ff; color: var(--color-accent); transform: scale(1.02); }
  100% { background-color: var(--color-light); color: var(--color-text-dark); transform: scale(1); }
}

/* Tooltips */
.form-group { position: relative; }
.tooltip { display: none; position: absolute; left: 0; top: -2rem; background: var(--color-light); color: var(--color-text-dark); padding: 0.35rem 0.55rem; border-radius: 6px; font-size: 0.8rem; white-space: normal; max-width: 95%; box-shadow: 0 4px 12px rgba(0,0,0,0.12); border: 1px solid #ccc; }
.form-group:focus-within .tooltip { display: block; }

/* Teléfono */
.phone-row { display: flex; gap: 0.5rem; align-items: center; }
.phone-row select { width: 35%; min-width: 110px; }
.phone-row input { flex: 1; }

/* Mensajes */
.mensaje { margin-top: 1rem; font-size: 0.95rem; padding: 0.75rem; border-radius: 8px; text-align: center; background: #FFF4CC; color: #665c00; border: 1px solid #FFE08A; }

/* Footer */
footer { color: #888; text-align: center; padding: 0.8rem 0.5rem; font-size: 0.8rem; margin-top: 1.5rem; }

/* Optimización pop-up móviles (tus existentes) */
@media (max-width: 600px) {
  .popUp {
    width: 90%;
    max-width: 400px;
    padding: 1.5rem;
    border-radius: 16px;
  }
  .popUp form input,
  .popUp form textarea,
  .popUp form select,
  .popUp button { font-size: 1rem; }
  .popUp form label { font-size: 0.95rem; }
  .popUp form textarea { min-height: 80px; }
}

/* --------- NUEVOS: OVERLAYS DE CONTRASEÑA --------- */
.authOverlay {
  position: fixed; inset: 0;
  display: flex; align-items: center; justify-content: center;
  background: rgba(0,0,0,0.35);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  z-index: 10000;
}
.authBox {
  background: var(--color-light);
  border-radius: 12px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.25);
  padding: 1.25rem;
  width: 92%;
  max-width: 340px;
  text-align: center;
}
.authBox h2 { color: var(--color-accent); font-size: 1.2rem; margin-bottom: 0.75rem; }
.authBox input {
  width: 100%; padding: 0.65rem; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 0.75rem;
}
.authBox .btn {
  width: 100%; padding: 0.65rem; border: none; border-radius: 8px; font-weight: 700; cursor: pointer;
  background: var(--color-accent); color: #fff;
}
.authBox .btn.secondary { background: #888; }
.authError { color: #e53935; font-size: 0.9rem; display: none; margin-top: 0.25rem; }

#estadisticas-container { margin-top: 0.75rem; }
#estadisticasFrame {
  width: 100%;
  min-height: 70vh;
  border: 0;
  border-radius: 12px;
  background: #fff;
}
.stats-container {
  width: 100%;
  max-width: 100%;
  background: rgba(255, 255, 255, 0.05);
  padding: 15px;
  border-radius: 10px;
  box-sizing: border-box;
  margin: 0 auto;
}

/* Fondo del lightbox con blur */
.lightbox {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(5px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

/* Oculto por defecto */
.hidden {
  display: none;
}
.link-btn {
  display: flex;
  justify-content: center;
  align-items: center;
  background: var(--color-accent);
  color: #fff;
  text-decoration: none;
  padding: .56rem 6rem;
  border-radius: 999px;
  font-weight: 700;
  font-size: 1rem;
  max-width: 220px;
  margin: 0.3rem auto;
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
  transition: transform .12s;
  white-space: nowrap;
}
.link-btn:hover {
  transform: translateY(-3px);
  background: #1f3a66;
}

/* Caja del lightbox */
.lightbox-content {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  max-width: 400px;       /* ancho máximo */
  width: 90%;              /* ancho relativo a la pantalla */
  max-height: 70vh;        /* altura máxima: 70% de la ventana */
  overflow-y: auto;        /* scroll vertical si el contenido es largo */
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  text-align: left;
  position: relative;
}

/* Asegura que los párrafos respeten saltos de línea y no se corten */
.lightbox-content p {
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Botón cerrar (similar al sitio) */
.close-lightbox {
  position: absolute;
  top: 10px;
  right: 10px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
}
/* Variante para colocar la X en la esquina superior izquierda (pedido) */
.close-lightbox.left {
  left: 10px;
  right: auto;
}

/* Botón eliminar */
.btn-eliminar {
  margin-top: 20px;
  padding: 10px 15px;
  border: none;
  background: #e74c3c;
  color: #fff;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.2s ease;
}
.btn-eliminar:hover {
  background: #c0392b;
}

/* Estilos para los títulos dentro del lightbox de pedido (negrita como en formulario) */
.lb-field { font-weight:700; margin-top: 8px; }
.lb-value { margin-top: 4px; color:#333; }

/* Confirmación aviso (check circular) */
.confirmAviso {
  position: fixed;
  inset: 0;
  display: flex; align-items:center; justify-content:center;
  background: rgba(0,0,0,0.35);
  z-index: 1100;
  opacity: 0;
  pointer-events: none;
  transition: opacity .25s ease;
}
.confirmAviso.show { opacity: 1; pointer-events: auto; }
.confirmBox {
  background: #fff; padding: 1rem 1.1rem; border-radius: 12px; text-align:center; width: 88%; max-width: 360px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.2);
}
.check-icon {
  width:72px;height:72px;border-radius:999px;margin:0 auto 0.6rem;display:flex;align-items:center;justify-content:center;background:rgba(47,82,143,0.08);
}
.check-icon svg { display:block; }

/* small helper for bold label spacing */
.lb-row { margin-bottom: 6px; }

/* responsive tweaks */
@media (max-width:420px){
  nav { flex-direction: column; gap:.45rem; }
}
  /* ===== Forzar botones del nav en una sola fila en móviles =====
   Pegar al final del <style> (sobre-escribe rules previas que los apilen)
*/
@media (max-width: 600px) {
  header nav {
    display: flex;
    flex-direction: row !important;   /* asegurar fila */
    flex-wrap: nowrap;                /* no se rompen a siguiente línea */
    gap: .45rem;
    overflow-x: auto;                 /* permitir scroll horizontal si hacen overflow */
    -webkit-overflow-scrolling: touch;
    padding-bottom: 6px;              /* espacio para scroll */
  }

  /* Cada botón se comporta como elemento fijo (no se estira) */
  header nav button {
    flex: 0 0 auto !important;
    min-width: 110px;                 /* ancho mínimo para que sigan siendo legibles */
    padding: .55rem .6rem;
    font-size: .95rem;
    white-space: nowrap;              /* evitar salto de texto dentro del botón */
  }

  /* Opcional: ocultar scrollbar en WebKit pero mantener scroll táctil */
  header nav::-webkit-scrollbar { height: 6px; }
  header nav::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.08); border-radius: 6px; }
}

/* Extra: si quieres forzar aún más en pantallas muy estrechas, reduce min-width */
@media (max-width: 360px) {
  header nav button { min-width: 92px; font-size: .88rem; padding: .45rem .5rem; }
}

</style>
</head>
<body>

<div id="app"><!-- wrapper para blur si hiciera falta -->

<header>
<h1>Panel del Operador</h1>
<nav>
<button id="btnInicio">Inicio</button>
<button id="btnPedidos" class="inactive">Pedidos</button>
<button id="btnAgregar" class="inactive">Agregar Paquete</button>
<button id="btnActualizar" class="inactive">Actualizar Seguimiento</button>
<button id="btnEstadisticas" class="inactive">Estadísticas</button>
</nav>
</header>

<!-- Inicio: Recordatorios -->
<section id="inicio" class="active">
<h2>Inicio</h2>
<div id="listaRecordatorios">
  <p>No hay recordatorios por el momento.</p>
</div>
<button id="btnAgregarRecord" class="action-btn">Agregar Recordatorio</button>

<!-- Pop-up Formulario -->
<div class="popUp" id="popFormRecord">
<h3>Agregar Recordatorio</h3>
<form id="formRecord">
  <label for="tituloRecord">Título del recordatorio</label>
  <input type="text" id="tituloRecord" placeholder="Ej: Llamada importante" required>
  <label for="descRecord">Descripción</label>
  <textarea id="descRecord" rows="2" placeholder="Ej: Llamar a cliente, enviar factura..." required></textarea>
  <label for="fechaRecord">Fecha límite</label>
  <input type="date" id="fechaRecord" required>
  <button type="submit" class="action-btn">Agregar</button>
  <button type="button" id="cerrarPopForm" class="action-btn" style="background:#888;">Cancelar</button>
</form>
</div>

<!-- Pop-up Confirmación Agregado -->
<div class="confirmPop" id="popConfirm">
<p>Recordatorio agregado</p>
<button id="cerrarPopConfirm" class="action-btn">Cerrar</button>
</div>

<!-- Pop-up Confirmación Eliminar -->
<div class="confirmPop" id="popEliminarConfirm">
<p>¿Desea eliminar este recordatorio?</p>
<button id="btnConfirmEliminar" class="action-btn" style="background:#f56565;">Eliminar</button>
<button id="btnCancelarEliminar" class="action-btn" style="background:#888;">Cancelar</button>
</div>
</section>

<!-- PEDIDOS (nuevo) -->
<section id="pedidos">
  <h2>Pedidos</h2>
  <div id="listaPedidos">
    <!-- Items prellenados desde JS -->
  </div>
  <p class="small-muted" style="margin-top:8px;">Estos son pedidos de ejemplo (datos de prueba).</p>
</section>

<!-- Agregar Paquete -->
<section id="agregar">
<h2>Registrar Paquete</h2>
<form id="formAgregar">
  <div class="form-group">
    <label for="nombre">Nombre del cliente</label>
    <div class="tooltip">Ingresa un nombre y un apellido</div>
    <input type="text" id="nombre" name="nombre" placeholder="Ej: Lester Gamez" required>
  </div>

  <!-- Nuevo campo opcional de código de seguimiento -->
  <div class="form-group">
    <label for="codigo">Código de seguimiento (opcional, max 10 dígitos)</label>
    <input type="text" id="codigo" name="codigo" maxlength="10" pattern="\d{0,10}" placeholder="Solo números">
  </div>

  <div class="form-group">
    <label for="telefonoDigits">Teléfono</label>
    <div class="tooltip">Selecciona (505) o (1) y luego ingresa de 8 a 10 dígitos</div>
    <div class="phone-row">
      <select id="telCode" name="telCode" required>
        <option value="(505)">(505)</option>
        <option value="(1)">(1)</option>
      </select>
      <input type="tel" id="telefonoDigits" name="telefonoDigits" placeholder="Ej: 12345678"
             inputmode="numeric" pattern="[0-9]{8,10}" title="Ingresa solo números (8 a 10 dígitos)" required>
    </div>
  </div>

  <div class="form-group">
    <label for="tipo">Tipo de envío</label>
    <select id="tipo" name="tipo" required>
      <option value="aereo">Aéreo</option>
      <option value="maritimo">Marítimo</option>
    </select>
  </div>

  <button type="submit" class="action-btn">Registrar Paquete</button>
</form>
<div id="mensajeAgregar" class="mensaje" style="display:none;">
Esta plataforma es de prueba, dog. Acción no disponible por el momento.
</div>
</section>

<!-- Actualizar Seguimiento -->
<section id="actualizar">
<h2>Actualizar Estado</h2>
<form id="formActualizar">
  <div class="form-group">
    <label for="nombreSeg">Nombre del cliente</label>
    <div class="tooltip">Ingresa un nombre y un apellido</div>
    <input type="text" id="nombreSeg" name="nombreSeg" placeholder="Ej: Lester Gamez">
  </div>

  <!-- Nuevo campo opcional de código de seguimiento -->
 <div class="form-group">
    <label for="codigoSeg">Código de seguimiento (obligatorio, max 10 dígitos)</label>
    <input type="text" id="codigoSeg" name="codigoSeg" maxlength="10" pattern="\d{1,10}" placeholder="Solo números" required>
  </div>

  <div class="form-group">
    <label for="telefonoSegDigits">Teléfono</label>
    <div class="tooltip">Selecciona (505) o (1) y luego ingresa de 8 a 10 dígitos</div>
    <div class="phone-row">
      <select id="telCodeSeg" name="telCodeSeg">
        <option value="(505)">(505)</option>
        <option value="(1)">(1)</option>
      </select>
      <input type="tel" id="telefonoSegDigits" name="telefonoSegDigits" placeholder="Ej: 12345678"
             inputmode="numeric" pattern="[0-9]{8,10}" title="Ingresa solo números (8 a 10 dígitos)">
    </div>
  </div>

  <div class="form-group">
    <label for="estado">Estado del paquete</label>
    <select id="estado" name="estado">
      <option value="">-- Seleccione --</option>
      <option value="recibido">Recibido</option>
      <option value="en_transito">En tránsito</option>
      <option value="en_aduana">En Aduana</option>
      <option value="listo_recoger">Listo Para Recoger</option>
    </select>
  </div>

  <div class="form-group">
    <label for="pesoSeg">Peso en libras</label>
    <input type="number" id="pesoSeg" name="pesoSeg" step="0.1" min="0" placeholder="Ej: 1.0">
  </div>
  <div class="form-group">
  <label for="tarifaSeg">Tarifa en USD</label>
  <input type="number" id="tarifaSeg" name="tarifaSeg" step="0.1" min="0" placeholder="Ej: 1.1">
</div>


  <div class="form-group">
    <label for="fechaEstado">Ingrese fecha</label>
    <input type="date" id="fechaEstado" name="fechaEstado">
  </div>

  <button type="submit" class="action-btn">Actualizar Estado</button>
</form>
<div id="mensajeActualizar" class="mensaje" style="display:none;">
Esta plataforma es de prueba, dog. Acción no disponible por el momento.
</div>
</section>

<!-- ESTADÍSTICAS (Nueva sección) -->
<section id="estadisticas">
  <div id="estadisticas-container">
    <iframe id="estadisticasFrame" src="" title="Estadísticas"></iframe>
  </div>
 <a class="link-btn" href="https://irvinforbusinesses.github.io/plantillacatalogo/estadisticas.html" target="_blank">Vista completa</a>
</section>

<footer>
&copy; 2025. Irvin Prado. Ascende Superius - Seek Higher Things
</footer>

</div><!-- /#app -->

<!-- OVERLAY: LOCK INICIAL -->
<div id="lockOverlay" class="authOverlay">
  <div class="authBox">
    <h2>Acceso al Panel</h2>
    <input type="password" id="lockPass" placeholder="Contraseña">
    <button class="btn" id="lockSubmit">Entrar</button>
    <div class="authError" id="lockError">Contraseña incorrecta</div>
  </div>
</div>

<!-- OVERLAY: ESTADÍSTICAS -->
<div id="statsOverlay" class="authOverlay" style="display:none;">
  <div class="authBox">
    <h2>Acceso a Estadísticas</h2>
    <input type="password" id="statsPass" placeholder="Contraseña">
    <button class="btn" id="statsSubmit">Acceder</button>
    <button class="btn secondary" id="statsCancel" style="margin-top:0.5rem;">Cancelar</button>
    <div class="authError" id="statsError">Contraseña incorrecta</div>
  </div>
</div>

<!-- Lightbox Recordatorio (existente) -->
<div id="lightbox-recordatorio" class="lightbox hidden">
  <div class="lightbox-content">
    <button class="close-lightbox">&times;</button>
    <h2>Recordatorio</h2>
    <p>Versión de prueba, datos no disponibles</p>
    <button class="btn-eliminar">Eliminar recordatorio</button>
  </div>
</div>

<!-- Lightbox Pedido (nuevo) -->
<div id="lightbox-pedido" class="lightbox hidden" aria-hidden="true">
  <div class="lightbox-content" role="dialog" aria-modal="true" aria-labelledby="lbPedidoTitle">
    <!-- X en esquina superior izquierda (igual estilo, pero left) -->
    <button class="close-lightbox left" id="closePedido">&times;</button>
    <h2 id="lbPedidoTitle" style="text-align:center;margin-bottom:8px;">Pedido</h2>

    <!-- Campos (títulos exactamente como en el formulario en negrita) -->
    <div class="lb-row"><div class="lb-field">Nombre</div><div class="lb-value" id="lbNombre"></div></div>
    <div class="lb-row"><div class="lb-field">Teléfono</div><div class="lb-value" id="lbTelefono"></div></div>
    <div class="lb-row"><div class="lb-field">Plataforma / Agencia</div><div class="lb-value" id="lbPlataforma"></div></div>
    <div class="lb-row"><div class="lb-field">Descripción</div><div class="lb-value" id="lbDescripcion"></div></div>
    <div class="lb-row"><div class="lb-field">Tipo de envío</div><div class="lb-value" id="lbTipo"></div></div>
    <div class="lb-row"><div class="lb-field">Peso aproximado (libras)</div><div class="lb-value" id="lbPeso"></div></div>

    <!-- Botones: Rechazar y Aceptar (solo dos botones) -->
    <div style="display:flex;gap:8px;margin-top:12px;">
      <button id="btnRechazarPedido" class="btn-eliminar" style="flex:1;">Rechazar pedido</button>
      <button id="btnAceptarPedido" class="action-btn" style="flex:1;background:#2F528F;">Aceptar pedido</button>
    </div>
  </div>
</div>

<!-- Confirmación visual (check circular) que aparece al rechazar/aceptar -->
<div id="confirmAviso" class="confirmAviso" aria-hidden="true">
  <div class="confirmBox" role="dialog" aria-modal="true">
    <div class="check-icon" aria-hidden="true">
      <!-- SVG check circular -->
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <circle cx="12" cy="12" r="10" stroke="none" fill="transparent"/>
        <path d="M9 12.5l2 2 4-4" stroke="#2F528F" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
      </svg>
    </div>
    <h3 style="color:var(--color-accent);margin-bottom:6px;">Se le avisó al cliente</h3>
    <p style="color:#444;margin-bottom:10px;">El cliente será notificado por WhatsApp con los detalles.</p>
    <button id="btnCerrarAviso" class="action-btn" style="background:var(--color-accent);">Cerrar</button>
  </div>
</div>

<script>
// ================== NAVEGACIÓN (ajustada para incluir Pedidos) ==================
const btnInicio = document.getElementById('btnInicio');
const btnPedidos = document.getElementById('btnPedidos');
const btnAgregar = document.getElementById('btnAgregar');
const btnActualizar = document.getElementById('btnActualizar');
const btnEstadisticas = document.getElementById('btnEstadisticas');

const secciones = {
  inicio: document.getElementById('inicio'),
  pedidos: document.getElementById('pedidos'),
  agregar: document.getElementById('agregar'),
  actualizar: document.getElementById('actualizar'),
  estadisticas: document.getElementById('estadisticas')
};

function mostrarSeccion(nombre){
  for(let sec in secciones) secciones[sec].classList.remove('active');
  if(secciones[nombre]) secciones[nombre].classList.add('active');

  // reset nav buttons
  [btnInicio, btnPedidos, btnAgregar, btnActualizar, btnEstadisticas].forEach(b => b.classList.add('inactive'));
  if(nombre==='inicio') btnInicio.classList.remove('inactive');
  if(nombre==='pedidos') btnPedidos.classList.remove('inactive');
  if(nombre==='agregar') btnAgregar.classList.remove('inactive');
  if(nombre==='actualizar') btnActualizar.classList.remove('inactive');
  if(nombre==='estadisticas') btnEstadisticas.classList.remove('inactive');
}
btnInicio.addEventListener('click',()=>mostrarSeccion('inicio'));
btnPedidos.addEventListener('click',()=>mostrarSeccion('pedidos'));
btnAgregar.addEventListener('click',()=>mostrarSeccion('agregar'));
btnActualizar.addEventListener('click',()=>mostrarSeccion('actualizar'));
btnEstadisticas.addEventListener('click',()=>{
  document.getElementById('statsOverlay').style.display = 'flex';
});

// ================== FECHA ACTUAL PRESELECCIONADA ==================
document.getElementById("fechaEstado").value = new Date().toISOString().split('T')[0];

// ================== FORMULARIOS DEMO (tus originales) ==================
document.getElementById("formAgregar").addEventListener("submit", function(e){
  e.preventDefault(); this.reset(); document.getElementById("mensajeAgregar").style.display="block";
  setTimeout(()=>document.getElementById("mensajeAgregar").style.display="none",3000);
});
document.getElementById("formActualizar").addEventListener("submit", function(e){
  e.preventDefault(); this.reset(); document.getElementById("mensajeActualizar").style.display="block";
  setTimeout(()=>document.getElementById("mensajeActualizar").style.display="none",3000);
  document.getElementById("fechaEstado").value = new Date().toISOString().split('T')[0];
});

// ================== RECORDATORIOS (tus originales) ==================
const listDiv = document.getElementById('listaRecordatorios');
const formR = document.getElementById('formRecord');
const popForm = document.getElementById('popFormRecord');
const popConfirm = document.getElementById('popConfirm');
const popEliminarConfirm = document.getElementById('popEliminarConfirm');
const btnAgregarRecord = document.getElementById('btnAgregarRecord');
const cerrarPopForm = document.getElementById('cerrarPopForm');
const cerrarPopConfirm = document.getElementById('cerrarPopConfirm');
const btnConfirmEliminar = document.getElementById('btnConfirmEliminar');
const btnCancelarEliminar = document.getElementById('btnCancelarEliminar');
const fechaInput = document.getElementById('fechaRecord');
let indexEliminar=null;

fechaInput.value = new Date().toISOString().split('T')[0];

function cargarRecord(){
  const arr = JSON.parse(localStorage.getItem('recordatorios')||'[]');
  const hoy = new Date().toISOString().split('T')[0];
  listDiv.innerHTML='';
  const activos = arr.filter(r=>r.fecha>=hoy);
  if(!activos.length){ listDiv.innerHTML='<p>No hay recordatorios por el momento.</p>'; return;}
  activos.forEach((r,index)=>{
   const div = document.createElement('div');
div.classList.add('recordatorio-item');
div.dataset.index = index;  // <-- aquí asignas el índice al div
div.innerHTML = `
  <div class="recordatorio-info"><strong>${r.titulo}</strong><br>${r.desc}<br><small>${r.fecha}</small></div>
  <button class="btnEliminar" data-index="${index}">X</button>`;

    listDiv.appendChild(div);
    if(r.fecha===hoy){ div.querySelector('.recordatorio-info').style.animation="parpadeo 1.2s infinite"; }
  });
}
cargarRecord();

btnAgregarRecord.addEventListener('click', ()=>{ popForm.style.display='block'; });
cerrarPopForm.addEventListener('click', ()=>{ popForm.style.display='none'; });

formR.addEventListener('submit', e=>{
  e.preventDefault();
  const arr = JSON.parse(localStorage.getItem('recordatorios')||'[]');
  arr.push({titulo:document.getElementById('tituloRecord').value, desc:document.getElementById('descRecord').value, fecha:fechaInput.value});
  localStorage.setItem('recordatorios', JSON.stringify(arr));
  formR.reset(); fechaInput.value=new Date().toISOString().split('T')[0];
  popForm.style.display='none'; popConfirm.style.display='block';
  cargarRecord();
});
cerrarPopConfirm.addEventListener('click', ()=>{ popConfirm.style.display='none'; });

btnCancelarEliminar.addEventListener('click', ()=>{ popEliminarConfirm.style.display='none'; indexEliminar=null; });
btnConfirmEliminar.addEventListener('click', ()=>{
  const arr = JSON.parse(localStorage.getItem('recordatorios')||'[]');
  arr.splice(indexEliminar,1);
  localStorage.setItem('recordatorios', JSON.stringify(arr));
  cargarRecord();
  popEliminarConfirm.style.display='none';
  indexEliminar=null;
});

// ================== NUEVO: Pedidos (ejemplos preseleccionados) ==================
const listaPedidosDiv = document.getElementById('listaPedidos');

// Generador simple de teléfono USA aleatorio de 10 dígitos
function generarUSNumber(){
  const n = Math.floor(Math.random()*900000000) + 100000000; // 9 digits + leading 1
  // Ajustar a 10 dígitos con prefijo 1
  return `(1) ${String(Math.floor(100 + Math.random()*900))}-${String(Math.floor(100 + Math.random()*900))}-${String(Math.floor(1000 + Math.random()*9000))}`;
}

// Crear pedidos de muestra
const pedidosEjemplo = [
  {
    id: 'pedido-1',
    nombre: 'Lester Games',
    telefono: generarUSNumber(),
    plataforma: 'El Campo / Amazon',
    descripcion: '3 perfumes: Acme Bliss 50ml, Acme Noir 75ml, Acme Fresh 30ml',
    tipo: 'Marítimo',
    peso: '2'
  },
  {
    id: 'pedido-2',
    nombre: 'Ana Morales',
    telefono: '(505) 87234567',
    plataforma: 'El Campo / Tienda Demo',
    descripcion: 'Caja con 2 camisetas y 1 zapatilla (marca DemoSport)',
    tipo: 'Aéreo',
    peso: '1.5'
  }
];

// Renderizar pedidos en la lista (misma estética que recordatorios)
function renderPedidos(){
  listaPedidosDiv.innerHTML = '';
  pedidosEjemplo.forEach((p, idx) => {
    const div = document.createElement('div');
    div.className = 'pedido-item';
    div.dataset.index = idx;
    div.innerHTML = `
      <div class="pedido-info"><strong>${p.nombre}</strong><div class="small-muted">${p.plataforma}</div></div>
      <div class="pedido-meta">${p.tipo}</div>
    `;
    listaPedidosDiv.appendChild(div);
  });
}
renderPedidos();

// ================== Lightbox Pedidos: interacción ==================
const lbPedido = document.getElementById('lightbox-pedido');
const lbClosePedido = document.getElementById('closePedido');
const lbNombre = document.getElementById('lbNombre');
const lbTelefono = document.getElementById('lbTelefono');
const lbPlataforma = document.getElementById('lbPlataforma');
const lbDescripcion = document.getElementById('lbDescripcion');
const lbTipo = document.getElementById('lbTipo');
const lbPeso = document.getElementById('lbPeso');

const btnRechazarPedido = document.getElementById('btnRechazarPedido');
const btnAceptarPedido = document.getElementById('btnAceptarPedido');

let pedidoSeleccionadoIndex = null;

// Delegación: click en listaPedidosDiv
listaPedidosDiv.addEventListener('click', (e) => {
  const item = e.target.closest('.pedido-item');
  if(!item) return;
  pedidoSeleccionadoIndex = Number(item.dataset.index);
  const p = pedidosEjemplo[pedidoSeleccionadoIndex];
  // llenar campos en lightbox
  lbNombre.textContent = p.nombre;
  lbTelefono.textContent = p.telefono;
  lbPlataforma.textContent = p.plataforma;
  lbDescripcion.textContent = p.descripcion;
  lbTipo.textContent = p.tipo;
  lbPeso.textContent = `${p.peso} lb`;
  // mostrar lightbox
  lbPedido.classList.remove('hidden');
});

// Cerrar lightbox (X)
lbClosePedido.addEventListener('click', ()=>{ lbPedido.classList.add('hidden'); });

// Cerrar si clic fuera de contenido
lbPedido.addEventListener('click', (e)=>{
  if(e.target === lbPedido) lbPedido.classList.add('hidden');
});

// acciones Rechazar/Aceptar -> muestran modal de confirmación (mismo para ambos)
const confirmAviso = document.getElementById('confirmAviso');
const btnCerrarAviso = document.getElementById('btnCerrarAviso');

function showConfirmAviso(){
  confirmAviso.classList.add('show');
  // cerrar lightbox si estaba abierto
  lbPedido.classList.add('hidden');
}
function hideConfirmAviso(){
  confirmAviso.classList.remove('show');
}
btnRechazarPedido.addEventListener('click', ()=> showConfirmAviso());
btnAceptarPedido.addEventListener('click', ()=> showConfirmAviso());
btnCerrarAviso.addEventListener('click', ()=> hideConfirmAviso());

// cerrar confirm al clickear afuera
confirmAviso.addEventListener('click', (e)=>{
  if(e.target === confirmAviso) hideConfirmAviso();
});

// ================== CONTRASEÑAS/OVERLAYS ==================
const PASS_LOCK  = "12345678"; // puedes cambiarlas luego
const PASS_STATS = "12345678";

const appWrapper   = document.getElementById('app');
const lockOverlay  = document.getElementById('lockOverlay');
const statsOverlay = document.getElementById('statsOverlay');

const lockPass   = document.getElementById('lockPass');
const lockSubmit = document.getElementById('lockSubmit');
const lockError  = document.getElementById('lockError');

const statsPass    = document.getElementById('statsPass');
const statsSubmit  = document.getElementById('statsSubmit');
const statsCancel  = document.getElementById('statsCancel');
const statsError   = document.getElementById('statsError');

const statsFrame   = document.getElementById('estadisticasFrame');

// Mostrar blur al inicio (por si el navegador no soporta backdrop-filter)
appWrapper.style.filter = 'blur(6px)';

// LOCK INICIAL
function tryUnlock(){
  if (lockPass.value === PASS_LOCK){
    lockError.style.display = 'none';
    lockOverlay.style.display = 'none';
    appWrapper.style.filter = 'none';
    lockPass.value = '';
  } else {
    lockError.style.display = 'block';
  }
}
lockSubmit.addEventListener('click', tryUnlock);
lockPass.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') tryUnlock(); });

// ESTADÍSTICAS
function openStats(){
  statsOverlay.style.display = 'flex';
  statsError.style.display = 'none';
  statsPass.value = '';
  statsPass.focus();
}
function closeStats(){
  statsOverlay.style.display = 'none';
}
function loadStatsIfAuthorized(){
  if (statsPass.value === PASS_STATS){
    statsError.style.display = 'none';
    closeStats();
    if (statsFrame.src !== 'https://irvinforbusinesses.github.io/plantillacatalogo/estadisticas.html'){
      statsFrame.src = 'https://irvinforbusinesses.github.io/plantillacatalogo/estadisticas.html';
    }
    mostrarSeccion('estadisticas');
    statsPass.value = '';
  } else {
    statsError.style.display = 'block';
  }
}
statsSubmit.addEventListener('click', loadStatsIfAuthorized);
statsPass.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') loadStatsIfAuthorized(); });
statsCancel.addEventListener('click', closeStats);

// ===== LIGHTBOX RECORDATORIOS (tu código original) =====
const lightbox = document.getElementById('lightbox-recordatorio');
const closeBtn = document.querySelector('#lightbox-recordatorio .close-lightbox');
const lbDelete = document.querySelector('#lightbox-recordatorio .btn-eliminar');
let indexSeleccionado = null;

listDiv.addEventListener('click', (e) => {
  const eliminarBtn = e.target.closest('.btnEliminar');
  if (eliminarBtn) {
    indexEliminar = eliminarBtn.dataset.index;
    popEliminarConfirm.style.display='block';
    return;
  }
  const item = e.target.closest('.recordatorio-item');
  if (item) {
    indexSeleccionado = Number(item.dataset.index);
    const arr = JSON.parse(localStorage.getItem('recordatorios')||'[]');
    const r = arr[indexSeleccionado];

    const titleEl = lightbox.querySelector('h2');
    const pEl = lightbox.querySelector('p');

    if (r) {
      titleEl.textContent = r.titulo || 'Recordatorio';
      pEl.innerHTML = `${r.desc || ''}<br><small>${r.fecha || ''}</small>`;
    } else {
      titleEl.textContent = 'Recordatorio';
      pEl.textContent = 'Versión de prueba, datos no disponibles';
    }

    lightbox.classList.remove('hidden');
  }
});

closeBtn.addEventListener('click', () => {
  lightbox.classList.add('hidden');
});
lightbox.addEventListener('click', (e) => {
  if (e.target === lightbox) lightbox.classList.add('hidden');
});
lbDelete.addEventListener('click', () => {
  if (indexSeleccionado != null) {
    popEliminarConfirm.style.display = 'block';
  }
  lightbox.classList.add('hidden');
});

</script>
</body>
</html>
